document.addEventListener("alpine:init",()=>{Alpine.data("sexoChartComponent",()=>({chart:null,hasData:!1,init(){let a={chart:{fontFamily:"Inter, sans-serif",type:"donut",height:350,toolbar:{show:!0},events:{dataPointMouseEnter:(t,s,o)=>{let e=o.w.config.labels[o.dataPointIndex],i=o.w.config.series[o.dataPointIndex];this.chart.updateOptions({plotOptions:{pie:{donut:{labels:{total:{show:!0,label:e,formatter:()=>i}}}}}})},dataPointMouseLeave:()=>{this.chart.updateOptions({plotOptions:{pie:{donut:{labels:{total:{show:!0,label:"Total",formatter:(t)=>t.globals.seriesTotals.reduce((s,o)=>s+o,0)}}}}}})}}},fill:{colors:["#FF4560","#2b7fff"]},series:[],labels:[],plotOptions:{pie:{donut:{size:"65%",labels:{show:!0,total:{show:!0,label:"Total",formatter:(t)=>{if(t.globals.seriesTotals.length===0)return 0;return t.globals.seriesTotals.reduce((s,o)=>s+o,0)}}}}}},dataLabels:{enabled:!0,formatter:function(t){return t.toFixed(1)+"%"},dropShadow:{enabled:!1}},legend:{position:"bottom"},noData:{text:"Seleccione un diagn贸stico y rango de fechas."}};this.chart=new ApexCharts(this.$refs.chart,a),this.chart.render()},fetchData(a,t,s){if(!a||!t||!s){this.hasData=!1,this.chart.updateOptions({series:[],labels:[]});return}let o=new URLSearchParams({IdDiagnostico:a,FechaInicio:t,FechaFin:s});fetch(`/api/sexo-por-diagnostico?${o}`).then((e)=>e.json()).then((e)=>{if(e&&e.length>0)this.chart.updateOptions({series:e.map((i)=>i.cantidadAtenciones),labels:e.map((i)=>i.sexo)}),this.hasData=!0;else this.hasData=!1,this.chart.updateOptions({series:[],labels:[]})})}})),Alpine.data("edadesChartComponent",()=>({chart:null,hasData:!1,init(){let a={chart:{type:"bar",height:350,toolbar:{show:!0},fontFamily:"Inter, sans-serif"},series:[{name:"Atenciones",data:[]}],xaxis:{categories:[]},yaxis:{show:!1,labels:{show:!1}},plotOptions:{bar:{horizontal:!1,dataLabels:{position:"top"},borderRadiusApplication:"end",borderRadius:10}},fill:{colors:["#00E396"]},dataLabels:{enabled:!0,offsetY:-25,style:{fontSize:"14px",colors:["#304758"]}},grid:{show:!0,borderColor:"#e0e0e0",strokeDashArray:2},noData:{text:"Seleccione un diagn贸stico y rango de fechas."}};this.chart=new ApexCharts(this.$refs.chart,a),this.chart.render()},fetchData(a,t,s){if(!a||!t||!s){this.hasData=!1,this.chart.updateOptions({series:[{data:[]}],xaxis:{categories:[]}});return}let o=new URLSearchParams({IdDiagnostico:a,FechaInicio:t,FechaFin:s});fetch(`/api/edades-por-diagnostico?${o}`).then((e)=>e.json()).then((e)=>{if(e&&e.length>0)this.chart.updateOptions({series:[{data:e.map((i)=>i.cantidadAtenciones)}],xaxis:{categories:e.map((i)=>i.grupoEdad)}}),this.hasData=!0;else this.hasData=!1,this.chart.updateOptions({series:[{data:[]}],xaxis:{categories:[]}})})}})),Alpine.data("distritosChartComponent",()=>({chart:null,hasData:!1,init(){let a={chart:{type:"bar",height:350,toolbar:{show:!0},fontFamily:"Inter, sans-serif"},series:[{name:"Atenciones",data:[]}],xaxis:{categories:[],labels:{rotate:-45,style:{fontSize:"11px"}}},plotOptions:{bar:{horizontal:!1,dataLabels:{position:"top"},borderRadiusApplication:"end",borderRadius:10}},fill:{colors:["#2563eb"]},dataLabels:{enabled:!0,offsetY:-25,style:{fontSize:"14px",colors:["#304758"]}},grid:{show:!0,borderColor:"#e0e0e0",strokeDashArray:2},noData:{text:"Seleccione un diagn贸stico y rango de fechas."}};this.chart=new ApexCharts(this.$refs.chart,a),this.chart.render()},fetchData(a,t,s){if(!a||!t||!s){this.hasData=!1,this.chart.updateOptions({series:[{data:[]}],xaxis:{categories:[]}});return}let o=new URLSearchParams({IdDiagnostico:a,FechaInicio:t,FechaFin:s});fetch(`/api/distritos-por-diagnostico?${o}`).then((e)=>e.json()).then((e)=>{if(e&&e.length>0){let i=e.slice(0,10);this.chart.updateOptions({series:[{data:i.map((r)=>r.cantidadAtenciones)}],xaxis:{categories:i.map((r)=>`${r.nombreDistrito}`)}}),this.hasData=!0}else this.hasData=!1,this.chart.updateOptions({series:[{data:[]}],xaxis:{categories:[]}})})}})),Alpine.data("tiempoChartComponent",()=>({chart:null,hasData:!1,init(){let a=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],t={chart:{type:"area",height:350,toolbar:{show:!0},fontFamily:"Inter, sans-serif",zoom:{enabled:!0}},series:[{name:"Atenciones",data:[]}],xaxis:{categories:[],labels:{rotate:-45,style:{fontSize:"11px"}}},yaxis:{title:{text:"Cantidad de Atenciones"}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},fill:{colors:["#2563eb"]},markers:{size:4,colors:["#2563eb"],strokeColors:"#fff",strokeWidth:2,hover:{size:6}},grid:{show:!0,borderColor:"#e0e0e0",strokeDashArray:2},tooltip:{custom:function({series:s,seriesIndex:o,dataPointIndex:e,w:i}){let r=s[o][e];return'<div class="px-3 py-2 bg-white border border-slate-200 rounded shadow-lg"><div class="text-xs text-slate-500">'+i.globals.labels[e]+'</div><div class="text-sm font-semibold text-slate-800">Atenciones: '+r+"</div></div>"}},noData:{text:"Seleccione un diagn贸stico y rango de fechas."}};this.chart=new ApexCharts(this.$refs.chart,t),this.chart.render(),this.mesesCortos=a},fetchData(a,t,s){if(!a||!t||!s){this.hasData=!1,this.chart.updateOptions({series:[{data:[]}],xaxis:{categories:[]}});return}let o=new URLSearchParams({IdDiagnostico:a,FechaInicio:t,FechaFin:s});fetch(`/api/atenciones-por-dia?${o}`).then((e)=>e.json()).then((e)=>{if(e&&e.length>0){let i=e.map((n)=>{let[c,h,l]=n.fecha.split("T")[0].split("-");return`${l} ${this.mesesCortos[parseInt(h)-1]}`}),r=e.map((n)=>n.cantidadAtenciones);this.chart.updateOptions({series:[{name:"Atenciones",data:r}],xaxis:{categories:i}}),this.hasData=!0}else this.hasData=!1,this.chart.updateOptions({series:[{data:[]}],xaxis:{categories:[]}})})}}))});
